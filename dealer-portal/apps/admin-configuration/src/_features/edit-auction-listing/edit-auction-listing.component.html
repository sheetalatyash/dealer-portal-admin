<div class="edit-listing-wrapper min-vh-100 p-0">
  <form [formGroup]="listingForm" class="listing-form" (ngSubmit)="submitForm()">
    <div class="header-bar w-100 mb-4">
      <div class="container-fluid px-4 py-3 d-flex align-items-center justify-content-between">
        <div class="d-flex align-items-center gap-2">
          <div class="border border-2 border-danger rounded-circle p-2">
            <polaris-icon color="danger" size="xl">edit</polaris-icon>
          </div>
          <h1 class="mb-0 fs-5 fw-600">Edit Listing</h1>
        </div>

        <div class="d-flex align-items-center gap-2">
          <polaris-button ui-theme="tertiary" [compact]="true" type="button" (click)="cancelEdit()">{{
            'editListing.cancel' | translate
          }}</polaris-button>
          <polaris-button ui-theme="primary" [compact]="true" type="submit" (click)="saveChanges()">{{
            'editListing.save-changes' | translate
          }}</polaris-button>
        </div>
      </div>
    </div>

    <div class="container-fluid px-4 mb-4">
      <div class="info-banner p-3 d-flex align-items-center justify-content-between">
        <div class="d-flex align-items-center gap-3">
          <span class="status-badge d-inline-flex align-items-center">
            <polaris-icon size="lg" class="me-1">eye</polaris-icon>
            PUBLISHED
          </span>
          <span class="text-muted small">{{ 'editListing.published-text' | translate }}</span>
        </div>
        <polaris-select
          [options]="statusOptions"
          [ui-show-label]="false"
          ui-test-id="listing-status-select"
          [ui-class]="'status-select'"
        ></polaris-select>
      </div>
    </div>

    <div class="container-fluid px-4">
      <div class="row g-4 mb-4">
        <div class="col-12 col-lg-8">
          <div class="card-section p-4 mb-4">
            <h5 class="card-section-title pb-2 mb-3">{{ 'editListing.edit-details' | translate }}</h5>
            <hr class="my-0 mb-4" />
            <div class="mb-4">
              <label class="form-group-label d-block mb-2">{{ 'editListing.listing-title' | translate }}</label>
              <polaris-input
                [ui-label]="'Title'"
                ui-form-control-name="title"
                ui-test-id="edit-listing-title-input"
                [ui-placeholder]="'editListing.title-placeholder' | translate"
                [ui-show-label]="false"
              ></polaris-input>
            </div>

            <div class="mb-4">
              <label class="form-group-label d-block mb-2">{{ 'editListing.description' | translate }}</label>
              <polaris-textarea
                [ui-label]="'Description'"
                ui-form-control-name="description"
                ui-test-id="edit-listing-description-input"
                [ui-placeholder]="'editListing.description-placeholder' | translate"
                [ui-show-label]="false"
              ></polaris-textarea>
            </div>

            <div class="row g-3 mb-4">
              <div class="col-12 col-sm-6">
                <label class="form-group-label d-block mb-2">{{ 'editListing.starting-price' | translate }}</label>
                <polaris-input
                  [ui-label]="'Starting Price'"
                  ui-form-control-name="startingPrice"
                  ui-test-id="edit-listing-startingPrice-input"
                  [ui-placeholder]="'editListing.price-placeholder' | translate"
                  [ui-show-label]="false"
                  ui-type="number"
                ></polaris-input>
                <small class="d-flex align-items-start gap-2 mt-2 text-muted">
                  <polaris-icon size="lg" class="flex-shrink-0 mt-1">info</polaris-icon>
                  <span>{{ 'editListing.price-set-via-feed' | translate }}</span>
                </small>
              </div>

              <div class="col-12 col-sm-6">
                <label class="form-group-label d-block mb-2">{{ 'editListing.freight-cost' | translate }}</label>
                <polaris-input
                  [ui-label]="'Freight Cost'"
                  ui-form-control-name="freightCost"
                  ui-test-id="edit-listing-freightCost-input"
                  [ui-placeholder]="'editListing.freight-placeholder' | translate"
                  [ui-show-label]="false"
                  ui-type="number"
                ></polaris-input>
                <small class="d-flex align-items-start gap-2 mt-2 text-muted">
                  <polaris-icon size="lg" class="flex-shrink-0 mt-1">info</polaris-icon>
                  <span>{{ 'editListing.cost-set-via-feed' | translate }}</span>
                </small>
              </div>
            </div>

            <div class="mb-4">
              <div class="d-flex align-items-center justify-content-between mb-3">
                <h6 class="mb-0 fw-bold">{{ 'editListing.vehicles' | translate }}</h6>
                <a href="#" class="text-primary text-decoration-none small fw-500">{{
                  'editListing.add' | translate
                }}</a>
              </div>
              <polaris-divider ui-class="col-auto mb-3"></polaris-divider>

              <div class="vehicle-list">
                <div *ngFor="let vehicle of vehicles" class="card border mb-3">
                  <div class="card-body p-3">
                    <div class="row align-items-start">
                      <div class="col-auto">
                        <div
                          class="bg-light rounded d-flex align-items-center justify-content-center"
                          style="width: 80px; height: 80px"
                        >
                          <span class="text-muted small">Vehicle</span>
                        </div>
                      </div>

                      <div class="col">
                        <div class="fw-600 mb-2">{{ vehicle.name }}</div>
                        <div class="row g-2 small">
                          <div class="col-auto">
                            <span class="text-muted">Type:</span>
                            <span class="fw-500">{{ vehicle.type }}</span>
                          </div>
                          <div class="col-auto">
                            <span class="text-muted">Condition:</span>
                            <span class="ms-1">{{ vehicle.condition }}</span>
                          </div>
                        </div>
                      </div>

                      <div class="col-auto">
                        <button
                          class="vehicle-menu-button"
                          type="button"
                          [attr.aria-label]="'Vehicle menu for ' + vehicle.name"
                          [matMenuTriggerFor]="vehicleMenu"
                        >
                          <polaris-icon size="lg">more-horiz</polaris-icon>
                        </button>

                        <mat-menu #vehicleMenu="matMenu">
                          <ng-template matMenuContent>
                            <button mat-menu-item><polaris-icon size="lg">link</polaris-icon> View vehicle</button>
                            <button mat-menu-item><polaris-icon size="lg">link</polaris-icon>Manage photos</button>
                          </ng-template>
                        </mat-menu>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="col-12 col-lg-4">
          <div class="card-section p-4 mb-4">
            <h5 class="card-section-title pb-2 mb-3">{{ 'editListing.schedule' | translate }}</h5>
            <hr class="my-0 mb-3" />

            <div class="py-2 border-bottom">
              <div class="small text-muted text-uppercase fw-600">{{ 'editListing.start' | translate }}</div>
              <div class="fw-600">10:00 AM CST on 01/08/2025</div>
            </div>

            <div class="py-2">
              <div class="small text-muted text-uppercase fw-600">{{ 'editListing.end' | translate }}</div>
              <div class="fw-600">10:05 AM CST on 01/08/2025</div>
            </div>
          </div>

          <div class="card-section p-4">
            <h6 class="fw-600 pb-2 mb-3">{{ 'editListing.auction' | translate }}</h6>
            <hr class="my-0 mb-3" />
            <p class="small text-muted mb-3">{{ 'editListing.listing-part-of' | translate }} <strong>Test1</strong></p>
            <div class="d-flex gap-2">
              <polaris-button
                ui-theme="secondary"
                [compact]="true"
                type="button"
                (click)="editAuction()"
                class="flex-grow-1"
                >{{ 'editListing.edit-auction' | translate }}</polaris-button
              >
              <polaris-button
                ui-theme="secondary"
                [compact]="true"
                type="button"
                (click)="changeAuction()"
                class="flex-grow-1"
                >{{ 'editListing.change-auctions' | translate }}</polaris-button
              >
            </div>
          </div>
        </div>
      </div>
    </div>
  </form>
</div>
